<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="第一篇文章我们来聊聊什么是程序的局部性原理"><meta name="keywords" content="程序,深入理解计算机"><meta name="author" content="李增光"><meta name="copyright" content="李增光"><title>第一篇文章我们来聊聊什么是程序的局部性原理 | 把自己活成一直队伍</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第一篇文章我们来聊聊什么是程序的局部性原理"><span class="toc-number">1.</span> <span class="toc-text">第一篇文章我们来聊聊什么是程序的局部性原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#01、前言"><span class="toc-number">1.0.1.</span> <span class="toc-text">01、前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#02、什么是局部性原理"><span class="toc-number">1.0.2.</span> <span class="toc-text">02、什么是局部性原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#03、示例"><span class="toc-number">1.0.3.</span> <span class="toc-text">03、示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#04、相关应用"><span class="toc-number">1.0.4.</span> <span class="toc-text">04、相关应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1、CPU-缓存"><span class="toc-number">1.0.4.1.</span> <span class="toc-text">4.1、CPU 缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2、广义局部性"><span class="toc-number">1.0.4.2.</span> <span class="toc-text">4.2、广义局部性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3、利弊结合"><span class="toc-number">1.0.4.3.</span> <span class="toc-text">4.3、利弊结合</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#05、总结"><span class="toc-number">1.0.5.</span> <span class="toc-text">05、总结</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://i.loli.net/2019/11/29/wCfvsQlImTgWn2P.jpg"></div><div class="author-info__name text-center">李增光</div><div class="author-info__description text-center">把自己活成一直队伍</div><div class="follow-button"><a href="https://github.com/itguang" target="_blank" rel="noopener">Github</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">4</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">5</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">2</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" href="hhttps://blog.csdn.net/itguangit" target="_blank" rel="noopener">只有变秃,才能变强</a><a class="author-info-links__name text-center" href="https://github.com/itguang" target="_blank" rel="noopener">Github-itguang</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2019/11/29/B2mz9RsanU1AktC.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">把自己活成一直队伍</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">第一篇文章我们来聊聊什么是程序的局部性原理</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-11-29</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">1.3k</span><span class="post-meta__separator">|</span><span>阅读时长: 3 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="第一篇文章我们来聊聊什么是程序的局部性原理"><a href="#第一篇文章我们来聊聊什么是程序的局部性原理" class="headerlink" title="第一篇文章我们来聊聊什么是程序的局部性原理"></a>第一篇文章我们来聊聊什么是程序的局部性原理</h1><h3 id="01、前言"><a href="#01、前言" class="headerlink" title="01、前言"></a>01、前言</h3><p>作为有追求的程序员，我们日常在写代码的时候往往都会运用很多奇技淫巧，不单单是为了炫耀我们的技术，更是为了追求更高的效率。了解局部性原理，可以有效的帮助我们理解和写出更好的代码，对于局部性原理可能有的小伙伴知道，有的小伙伴不知道，知道的小伙伴就当做复习知识点，不知道的小伙伴也没关系，接着往下看就知道了。</p>
<h3 id="02、什么是局部性原理"><a href="#02、什么是局部性原理" class="headerlink" title="02、什么是局部性原理"></a>02、什么是局部性原理</h3><p>说到局部性原理，那我们首先要知道什么是局部性原理，局部性原理分为两部分：</p>
<ul>
<li>时间局部性：指的是在程序运行过程中最近被引用到的存储器位置在程序执行后期还会被多次引用到的可能性很大。</li>
<li>空间局部性：指的是程序运行过程中如果一个存储器的位置被引用，那么在程序执行后期该存储器附近的位置被引用的可能性很大。</li>
</ul>
<p>简单来说就是一个变量在程序运行过程中，如果被引用过一次，那后续很有可能会再被引用到；一个变量被访问到过后，这个变量所在的位置附近的位置很有可能在程序后续运行中被访问到。</p>
<h3 id="03、示例"><a href="#03、示例" class="headerlink" title="03、示例"></a>03、示例</h3><p>上面是通过理论来说明的，下面我们通过一段代码来看看局部性y原理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">            sum = sum + array[i];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> sum;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>从上面的这段代码来看，就是一个很简单的数组元素求和，这里我们主要看 sum 和 array 两个变量，我们可以看到 sum 在每次循环中都会用到，另外它只是一个简单变量，所以我们可以看到，sum 是符合我们上面提到的时间局部性，再访问一次后还会被继续访问到，但是它不存在我们所说的空间局部性了。</p>
<p>相反的，array 数组中的每个元素只访问一次，另外数组底层的存储是连续的，所以 array 变量符合我们上面提到的空间局部性，但是不符合时间局部性。</p>
<p>这只是局部性原理的简单示例，对于局部性原理还有很多地方会用到，我们如果能熟练的掌握和使用，对我们的帮助会很大的。</p>
<h3 id="04、相关应用"><a href="#04、相关应用" class="headerlink" title="04、相关应用"></a>04、相关应用</h3><h4 id="4-1、CPU-缓存"><a href="#4-1、CPU-缓存" class="headerlink" title="4.1、CPU 缓存"></a>4.1、CPU 缓存</h4><p>上面的示例其实很简单，相信大家都能理解，另外局部性原理其实在我们日常使用的软件中随处可见，并且在操作系统中也少不了。我们知道 CPU 的速度是非常快的，而且 CPU 与内存之间有多级缓存，如下图（图片来源于网络）</p>
<p><img src="https://i.loli.net/2019/11/29/CPAnQDVIFEgzS3r.png" alt="image-20191129115010857.png"></p>
<p>为了充分的利用 CPU，操作系统会利用局部性原理，将高频的数据从内存中加载的缓存中，从而加快 CPU 的处理速度。</p>
<h4 id="4-2、广义局部性"><a href="#4-2、广义局部性" class="headerlink" title="4.2、广义局部性"></a>4.2、广义局部性</h4><p>其实我们的局部性原理不单单是上面提到的狭义性的局部性，还可以是广义的局部性。我们系统里面的热点数据，CDN 数据，微博的热点流量等等这些都利用了局部性原理。只是我们可能没有意识到而已，实际上已经在使用了。我们会通过 Redis 缓存热点数据，会通过 CDN 提前加载图片或者视频资源，等等，都是因为这些数据本身就符合局部性原理，合理的利用局部性可以得到了能效、成本上的提升。</p>
<h4 id="4-3、利弊结合"><a href="#4-3、利弊结合" class="headerlink" title="4.3、利弊结合"></a>4.3、利弊结合</h4><p>任何事情都是多面性的，局部性原理虽然我们使用起来很不错，可以提高系统性能，但是在有些场景下，我们是需要避免局部性原理的出现的。或者说出现了这种情况，我们需要人工处理。我们可以试想一下，如果在我们的一个大数据处理平台上，由于局部性原理的存在，导致我们部分节点数据庞大运算吃力，部分节点数据量小十分空闲，这种情况自然是不合理，我们就需要把数据按照业务场景进行重新分配，以达到整个集群的最大利用。</p>
<h3 id="05、总结"><a href="#05、总结" class="headerlink" title="05、总结"></a>05、总结</h3><p>今天给大家介绍了一下局部性原理，我们提到了时间局部性和空间局部性，通过一个代码示例和几个业务场景给大家简单介绍了局部性的使用。最后也提到局部性原理有利也有弊，我们需要根据业务场景和需求合理话的使用。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">李增光</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="/http:/yoursite.com/2019/11/29/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%88%91%E4%BB%AC%E6%9D%A5%E8%81%8A%E8%81%8A%E4%BB%80%E4%B9%88%E6%98%AF%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B1%80%E9%83%A8%E6%80%A7%E5%8E%9F%E7%90%86/">http://yoursite.com/2019/11/29/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%88%91%E4%BB%AC%E6%9D%A5%E8%81%8A%E8%81%8A%E4%BB%80%E4%B9%88%E6%98%AF%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B1%80%E9%83%A8%E6%80%A7%E5%8E%9F%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com">把自己活成一直队伍</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%A8%8B%E5%BA%8F/">程序</a><a class="post-meta__tags" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA/">深入理解计算机</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://i.loli.net/2019/11/29/mGlIJygh31cO7WS.jpg"><div class="post-qr-code__desc">请我喝一杯?</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://i.loli.net/2019/11/29/FaCli2fKRyhN6kL.png"><div class="post-qr-code__desc">请我吃一顿?</div></div></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/11/29/SpringBoot%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/"><i class="fa fa-chevron-left">  </i><span>SpringBoot自定义请求参数校验</span></a></div><div class="next-post pull-right"><a href="/2018/03/06/Slide-Sampple/"><span>Slide-Sample &amp; iframe</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2019/11/29/B2mz9RsanU1AktC.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By 李增光</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="footer_custom_text">豫ICP备19012033号 | <a href="https://molunerfinn.com" target="_blank" rel="noopener">把自己活成一直队伍</a></div><div class="icp"><a><span></span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>